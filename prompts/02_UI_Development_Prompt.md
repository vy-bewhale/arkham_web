# Промт 02: Разработка Пользовательского Интерфейса (UI) для Arkham Client Streamlit App

**Роль:** UX/UI Дизайнер

**Дата:** {{YYYY-MM-DD}} <!-- Замени на текущую дату -->

**Контекст:** Мы разрабатываем интерактивное веб-приложение Streamlit, которое позволит пользователям взаимодействовать с основными функциями библиотеки `arkham_client`. Приложение должно быть интуитивно понятным, эффективным и, что крайне важно, **компактным**, с учетом особенностей Streamlit (большие шрифты и отступы по умолчанию).

**Цель:** Спроектировать детальный пользовательский интерфейс для приложения. Это включает определение структуры, расположения элементов, потоков взаимодействия и конкретных виджетов Streamlit, которые будут использоваться. Результатом должен стать набор спецификаций, достаточных для последующей реализации.

**Основные Функции Библиотеки `arkham_client` для Отображения в UI:**

1.  **Инициализация `ArkhamMonitor`:** Происходит при запуске приложения с использованием API-ключа из `.env`.
2.  **Начальное Наполнение Кеша:** Важно для работы фильтров. Может быть выполнено при запуске или по кнопке.
3.  **Установка Фильтров:**
    *   Минимальная сумма в USD (`min_usd`): Числовой ввод.
    *   Временной период (`lookback`): Выбор из предопределенных значений (например, '1h', '24h', '7d', '30d') или ввод кастомного (например, '3h', '10d').
    *   Символы токенов (`token_symbols`): Множественный выбор из списка, полученного через `get_known_token_symbols()`.
    *   Имена/адреса отправителей (`from_address_names`): Множественный выбор из списка, полученного через `get_known_address_names()`.
    *   Имена/адреса получателей (`to_address_names`): Множественный выбор из списка, полученного через `get_known_address_names()`.
4.  **Получение и Отображение Транзакций:**
    *   Кнопка для запуска запроса транзакций.
    *   Параметр `limit` для количества запрашиваемых транзакций (числовой ввод).
    *   Отображение результатов в виде таблицы (Pandas DataFrame).
5.  **Отображение Содержимого Кеша (для информации):**
    *   Возможность просмотреть списки `get_known_address_names()` и `get_known_token_symbols()`.

**Требования к UI и Процесс Проектирования:**

1.  **Общая Структура Приложения:**
    *   **Вариант A (Боковая панель + Основная область):**
        *   Боковая панель (`st.sidebar`): для всех фильтров, кнопки инициализации кеша (если нужна отдельно), кнопки запроса транзакций, ввода лимита.
        *   Основная область: для отображения таблицы с транзакциями, информационных сообщений, возможно, для отображения содержимого кеша.
        *   *Оценка:* Интуитивность (9/10), Компактность (8/10 - если правильно организовать), Эффективность (8/10).
    *   **Вариант B (Вкладки в основной области):**
        *   Вкладка "Фильтры и Запрос": все элементы управления.
        *   Вкладка "Результаты": таблица с транзакциями.
        *   Вкладка "Состояние Кеша": информация о кеше.
        *   *Оценка:* Интуитивность (7/10 - может быть менее очевидно), Компактность (7/10), Эффективность (7/10).
    *   **Вариант C (Все в одной основной области с разделителями `st.expander`):**
        *   Секция "Фильтры" (в `st.expander`): все фильтры.
        *   Секция "Результаты": таблица и кнопка запроса.
        *   *Оценка:* Интуитивность (8/10), Компактность (9/10), Эффективность (8/10).
    *   **Выбор:** Обосновать выбор одного из вариантов или предложить комбинацию, стремясь к максимальной компактности и интуитивности.
    *   **Самокритика Выбора:** После выбора варианта, критически оценить его недостатки. Что может быть неудобно? Как это можно улучшить?

2.  **Стилизация для Компактности (CSS):**
    *   Продумать использование `st.markdown("<style>...</style>", unsafe_allow_html=True)` для уменьшения размеров шрифтов, отступов у виджетов (`st.text_input`, `st.multiselect`, `st.table/dataframe`, кнопки) примерно в 1.5-2 раза от стандартных.
    *   **Действие:** Подготовить примеры CSS-правил для основных элементов Streamlit.

3.  **Компоновка Элементов Управления (Фильтров):**
    *   Использовать `st.columns` для размещения нескольких фильтров в одной строке, где это уместно (например, `min_usd` и `lookback`).
    *   **Пример:**
        ```python
        col1, col2 = st.columns(2)
        with col1:
            min_usd = st.number_input("Min USD", ...)
        with col2:
            lookback = st.selectbox("Lookback", ...)
        ```
    *   Для `st.multiselect` (токены, адреса) предоставить опцию "Выбрать все" / "Очистить выбор", если это возможно стандартными средствами или с небольшой доработкой.
    *   Поля ввода должны иметь осмысленные метки (labels) и, возможно, короткие подсказки (`help`).

4.  **Процесс Первоначального Наполнения Кеша:**
    *   **Вариант 1 (Автоматически при старте):** Выполнять широкий запрос `get_transactions` (с параметрами по умолчанию или настраиваемыми глобально) при первом запуске сессии. Информировать пользователя о процессе.
        *   *Оценка:* Удобство (9/10), Контроль пользователя (6/10).
    *   **Вариант 2 (По кнопке):** Отдельная кнопка "Загрузить/Обновить кеш" с возможностью указать параметры для этого (например, `lookback_cache`, `min_usd_cache`, `limit_cache`).
        *   *Оценка:* Удобство (7/10), Контроль пользователя (9/10).
    *   **Выбор и Обоснование:** Выбрать оптимальный вариант.
    *   **Самокритика и Доработка:** Оценить минусы выбранного подхода (например, время ожидания при автоматической загрузке, лишний клик при ручной).

5.  **Отображение Транзакций:**
    *   Использовать `st.dataframe` для отображения DataFrame. Оно интерактивно (сортировка по колонкам).
    *   Рассмотреть, какие колонки из `transactions_df` наиболее важны для первоначального отображения. Возможно, не все сразу.
    *   Добавить кнопку "Скачать CSV" для выгрузки таблицы с результатами.

6.  **Обратная Связь и Уведомления:**
    *   Использовать `st.info`, `st.success`, `st.warning`, `st.error` для информирования пользователя о статусе операций (загрузка кеша, запрос транзакций, ошибки).
    *   Использовать `st.spinner` во время длительных операций.

7.  **Отображение Информации о Кеше:**
    *   Предусмотреть секцию (возможно, в `st.expander` или на отдельной вкладке), где пользователь может увидеть количество загруженных уникальных имен адресов и символов токенов.
    *   Возможность отобразить сами списки (например, в `st.text_area` или `st.json`).

8.  **Пошаговая Разработка UI (с самокритикой):**
    *   **Шаг 1:** Базовая структура (сайдбар/вкладки).
    *   **Шаг 2:** Размещение фильтров.
    *   **Шаг 3:** Механизм запроса и отображения данных.
    *   **Шаг 4:** Стилизация для компактности.
    *   **Шаг 5:** Обратная связь и информационные сообщения.
    *   **На каждом шаге:** Оценивать удобство, понятность, компактность. Задавать вопросы: "Это действительно лучший способ?", "Что может пойти не так с точки зрения пользователя?", "Как это можно упростить?". Вносить корректировки.

**Результат:**

*   Подробное описание выбранной структуры UI.
*   Список используемых виджетов Streamlit для каждой функции.
*   Примеры CSS для достижения компактности.
*   Описание потоков взаимодействия пользователя с приложением.
*   Этот документ будет служить основой для файла `streamlit_app/docs/UI_Specification.md` и для этапа разработки кода.

**Критерии Оценки для Выбора Вариантов UI:**

*   **Интуитивность:** Насколько легко пользователю понять, как пользоваться приложением (1-10).
*   **Компактность:** Насколько эффективно используется пространство экрана (1-10).
*   **Эффективность:** Насколько быстро пользователь может достичь своей цели (1-10).
*   **Расширяемость:** Насколько легко будет добавлять новые функции в UI (1-10).
*   **Эстетика:** Общее визуальное восприятие (1-10, меньший приоритет, но важно). 